<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∏–ª–µ–π –ø–∞–Ω–µ–ª–µ–π MoodBoard</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        .diagnostic {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 10000;
            max-width: 400px;
            font-size: 13px;
        }
        .status { margin: 8px 0; }
        .ok { color: green; }
        .warning { color: orange; }
        .error { color: red; }
        .code { background: #f5f5f5; padding: 2px 6px; border-radius: 3px; font-family: monospace; }
        #moodboard-container { width: 100vw; height: 100vh; }
        .fix-button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin: 8px 0;
            font-size: 12px;
        }
        .fix-button:hover { background: #ff5252; }
    </style>
</head>
<body>
    <div class="diagnostic">
        <h3>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–∞–Ω–µ–ª–µ–π MoodBoard</h3>
        <div class="status" id="critical-styles">–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Å—Ç–∏–ª–∏: <span>–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></div>
        <div class="status" id="panel-styles">–°—Ç–∏–ª–∏ –ø–∞–Ω–µ–ª–µ–π: <span>–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></div>
        <div class="status" id="panel-size">–†–∞–∑–º–µ—Ä –ø–∞–Ω–µ–ª–∏: <span>–û–∂–∏–¥–∞–Ω–∏–µ...</span></div>
        
        <button class="fix-button" onclick="fixPanelStyles()">
            üîß –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏ –ø–∞–Ω–µ–ª–µ–π
        </button>
        
        <div style="margin-top: 10px; font-size: 11px; color: #666;">
            –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞–Ω–µ–ª–∏ —Å–≤–æ–π—Å—Ç–≤
        </div>
    </div>

    <div id="moodboard-container"></div>

    <script type="module">
        let moodboard = null;
        
        try {
            // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å
            const module = await import('./src/index.js');
            const { quickInitMoodBoard, injectCriticalStyles, forceInjectPanelStyles } = module;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å—Ç–∏–ª–∏
            injectCriticalStyles();
            
            const criticalCheck = document.getElementById('moodboard-critical-styles');
            if (criticalCheck) {
                document.querySelector('#critical-styles span').innerHTML = '<span class="ok">‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã</span>';
            } else {
                document.querySelector('#critical-styles span').innerHTML = '<span class="error">‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</span>';
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º MoodBoard
            moodboard = quickInitMoodBoard('#moodboard-container', {
                theme: 'light',
                autoSave: false
            });
            
            // –§—É–Ω–∫—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π –ø–∞–Ω–µ–ª–µ–π
            window.fixPanelStyles = () => {
                forceInjectPanelStyles();
                
                setTimeout(() => {
                    const panel = document.querySelector('.text-properties-panel, .frame-properties-panel');
                    if (panel) {
                        const computedStyle = getComputedStyle(panel);
                        const width = parseInt(computedStyle.minWidth);
                        document.querySelector('#panel-size span').innerHTML = 
                            width >= 250 ? 
                            `<span class="ok">‚úÖ ${width}px (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)</span>` : 
                            `<span class="warning">‚ö†Ô∏è ${width}px (–≤—Å–µ –µ—â–µ —É–∑–∫–∞—è)</span>`;
                    }
                }, 200);
            };
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∏–ª–∏ –ø–∞–Ω–µ–ª–µ–π —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                const panel = document.querySelector('.text-properties-panel, .frame-properties-panel');
                if (panel) {
                    const computedStyle = getComputedStyle(panel);
                    const width = parseInt(computedStyle.minWidth);
                    
                    document.querySelector('#panel-styles span').innerHTML = '<span class="ok">‚úÖ –ù–∞–π–¥–µ–Ω—ã</span>';
                    document.querySelector('#panel-size span').innerHTML = 
                        width >= 250 ? 
                        `<span class="ok">‚úÖ ${width}px (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)</span>` : 
                        `<span class="error">‚ùå ${width}px (–£–ó–ö–ê–Ø)</span>`;
                        
                    if (width < 250) {
                        document.querySelector('#panel-size span').innerHTML += 
                            '<br><small>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏" –≤—ã—à–µ</small>';
                    }
                } else {
                    document.querySelector('#panel-styles span').innerHTML = '<span class="warning">‚ö†Ô∏è –ü–∞–Ω–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</span>';
                    document.querySelector('#panel-size span').innerHTML = '<span class="warning">‚ö†Ô∏è –°–æ–∑–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</span>';
                }
            }, 2000);
            
            window.moodboard = moodboard;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            document.querySelector('#critical-styles span').innerHTML = '<span class="error">‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞</span>';
        }
    </script>
    
    <script>
        console.log('üìù –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–ê–ù–ï–õ–ï–ô MOODBOARD:');
        console.log('1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É');
        console.log('2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∏ –≤—ã–¥–µ–ª–∏—Ç–µ –µ–≥–æ');
        console.log('3. –ü–∞–Ω–µ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —à–∏—Ä–æ–∫–æ–π (320px+)');
        console.log('4. –ï—Å–ª–∏ –ø–∞–Ω–µ–ª—å —É–∑–∫–∞—è - –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏"');
    </script>
</body>
</html>
